# [공모전 수상작] 공공데이터 기반 필지단위 매출 등급 예측 모델 개발

## 0. 대회 개요

  - 주최/주관 : 과학기술정보통신부, 한국지능정보사회진흥원, 한국부동산원

  - 부문 : 빅데이터 플랫폼 활용 분야 (부동산 빅데이터 플랫폼)

  - 기간 : 2023.09.01 ~ 2023.12.13

  - 주제 : **상업용 부동산 가치 창출을 위한 소상공인 매출등급 예측모형 제작 및 활용방안 제시**

    - (목표 1) "`필지 단위`" 서울시 소상공인(요식업) `매출등급 예측모형` 제작

    - (목표 2) 매출등급을 직관적으로 파악할 수 있는 `시각화` 방안 제시

    - (목표 3) 분석 결과 활용 `상권 활성화 방안 아이디어` 제시

  - 평가 : 예측 모형 성능 상위 20개 팀 대상 모델링 전반, 시각화 자료, 활용방안 제안내용 등 서류 심사 

    - (성능 지표) 대회 중간 ROC_AUC → **MSE**로 변경
      
      - **ROC_AUC**는 예측 확률의 스케일이나 정확도를 고려하지 않고, 순위 기반 지표로 정답과의 거리 차이를 반영하지 않음.
        
        - [(정답) 1등급 - (예측) 2등급] = [(정답) 1등급 - (예측) 4등급]
    
      - **MSE**는 예측값이 정답에 가까울수록 낮은 오차를 부여하여 정밀한 평가가 가능하며, 순서형 클래스 문제에서 더 적절한 지표로 사용됨. 따라서, 대회 중 평가지표가 변경된 것으로 해석됨.
        
        - [(정답) 1등급 - (예측) 2등급] > [(정답) 1등급 - (예측) 4등급]
    
    - (평가 데이터) 2023년 1~2월 데이터
        * 서울시 2022년 1~12월 데이터로 학습

  - 수상 : **최우수상 (한국부동산원장상)**

## 1. 프로젝트 설명

- **프로젝트 기간**: 2023.09.01 ~ 2023.11.13

- **목표**: 상업 부동산 시장 동향과 투자결정에 활용할 수 있는 인사이트 제공 및 상업용 부동산 매출등급 예측 모델 개발

- **분석 툴**: Python  
  - EDA: Numpy, Pandas  
  - 시각화: Matplotlib, Seaborn, Folium  
  - 모델링: Pycaret, Scikit-learn, Xgboost, LightGBM, Catboost  
  - 지리정보: QGIS  
  - 대시보드: Tableau

- **데이터 소스**: 서울시 열린데이터광장, 공공데이터포털

## **3. 주요 역할 및 기여**

### **(#1) 데이터 수집 및 전처리 (기여도 50%)**
- 수집된 43개 항목 데이터를 **도메인 Knowledge**를 기준으로 **6개 항목, 16개 데이터**로 선별
  * 예측 타겟인 "매출 등급(평당추정매출/평당월임대료)"을 설명할 수 있는 요인을 MECE하게 분석 진행
  * 그 결과 `"상권", "인구", "교통", "환경", "필지", "상가"` 6가지 항목으로 체계화 가능
  * 각 항목에 적합한 데이터를 **학습 적합성**을 기준으로 최종 선별

- **데이터 결합 로직 설계** 및 **결측치 처리**로 데이터 품질 향상 및 학습용 데이터 구축
  - (결합) 지오코딩 통해 좌표 추출 후, 시군구, 법정동, 좌표 단위 결합 진행 => 상이한 주소 기준(법정동/행정동)을 통일,  
  - (결측치) EDA를 통해 발견한 유사 특성을 가진 지역에 대해서 동일한 값으로 imputation 진행

### **(#2) 데이터 분석 및 모델링 (기여도 70%)**
- **EDA 및 피처 엔지니어링**: 지역별 매출 등급과 업종별 차이 분석, 중요한 피처 선별 및 **파생 피처** 생성
- **모델링 최적화**: PyCaret으로 베이스라인 모델 탐색 후, **하이퍼파라미터 튜닝**(GridSearch, Bayesian Optimization)을 통해 성능 최적화
  - Roc_auc, MSE, Accuracy 3가지 지표의 일반화된 성능 향상을 중심으로 튜닝 진행
  - Under Sampling, PCA, Soft Voting, Hard Voting 등 시도
- **Stacking Method 활용**: 최종 안정적인 성능 향상을 가져온 Stacking 방식 통해 모델 최적화 종료

### **(#3) 태블로 대시보드 시각화 (기여도 90%)**
- 매출 등급 **예측에 사용된 다양한 데이터**와 **지역별, 시기별 매출 등급** 분포 및 차이를 직관적으로 확인할 수 있는 인터렉티브 대시보드 제작
  * [태블로 대시보드 상세 설명](C:\Users\LeeSeungYong\myproject\BigContest_RealEstate\tableau_dashboard\Dashboard.md)

## 4. 주요 성과

- 필지 단위 데이터 결합 & 피처 엔지니어링 결과, 90개 컬럼 & 1156040 관측치를 보유한 학습 데이터 구축

- 모델링 결과, Eval Score (roc_auc 0.7302, mse 0.6038, accuracy 0.6382) 도출 => 모델링 퍼포먼스 기준 `상위 20등 이내 진입` 

- **2023년 빅콘테스트 빅데이터 플랫폼 활용 분야 (부동산 빅데이터 플랫폼 부문) 최우수상 수상**

## 5. 프로젝트 회고

- **데이터 핸들링의 어려움과 아쉬움**

  - 다양한 출처에서 데이터를 수집하다 보니, 각기 다른 기준으로 작업된 데이터들을 결합할 때 기준점 차이로 상당한 애로 사항이 있었음
  
  - 여러 차례 회의를 통해 결정한 로직(데이터 결합 기준, 결측치 처리 규칙)에 따라 가장 합리적으로 생각되는 방식으로 데이터를 결합했지만, 그 과정에서 정보 손실은 불가피했음

  - 데이터 전처리나 결합 과정에서 정보 손실을 최소화하려면 해결해야 되는 문제의 바탕이 되는 도메인 지식과 현장 전문가의 피드백이 필수적임을 깨달음
  
  - 캐글이나 데이콘처럼 잘 정제된 데이터가 아닌, 매우 raw한 데이터를 핸들링함으로써 현업에서 마주할 수 있는 도전 과제를 간접적으로 경험할 수 있어 의미있는 프로젝트였음

- **해석력 중심의 모델링 및 분석의 중요성**

  - 발표 평가 중 심사위원들의 피드백을 통해, 모델의 예측 성능만큼 모델의 설명력도 중요하다는 점을 체감

  - 데이터 사이언티스트로서 모델의 성능을 극대화하는데 작업의 최우선 목표가 집중될 수 있는데, 그 결과물을 사용하는 현장에서는 예측 정확도 못지않게 왜 그런 예측 결과가 도출되었는지, 비즈니스 문제 해결을 위해 어떤 요인(변수)에 주목해야 하는지가 중요할 수 있음
  
  - 따라서, 모델링 작업 이후 피쳐 중요도나 XAI 등을 통해 모델의 설명력을 확보하고 이를 외부 이해관계자가 쉽게 이해할 수 있도록 분석 레포트나 대시보드 등으로 커뮤니케이션하는 역량이 중요함을 인식
  
  - 실제 프로젝트 과정에서는 4가지(RF, XGB, LGB, KNN)에 대한 Stacking 방식으로 모델링을 진행하여, 메타 모델이 사용됨에 따라 피쳐 중요도 분석을 진행하기 어려웠음. Lime, SHAP 등을 통해 국지적인(필지별) 예측 결과 해석 또는 전반적인 변수들의 중요도 등을 분석할 필요가 있을 것으로 생각됨

## 6. 프로젝트 결과물

- 프로젝트 산출물 : commercial_realestate 디렉토리리

- [최종 발표 자료]([공모전] (최우수상) 2023 빅콘테스트 플랫폼활용분야 지정주제리그(부동산)/BigContest_RealEstate/commercial_realestate/우리4Lee_최종발표자료.pdf)

- [Tableau 대시보드](https://public.tableau.com/app/profile/seungyong.lee/viz/__16955237451750/sheet1)